# PaperBanana 사용자 매뉴얼

## 📚 목차

1. [PaperBanana 소개](#1-paperbanana-소개)
2. [시작하기](#2-시작하기)
   - [설치 방법](#21-설치-방법)
   - [첫 실행](#22-첫-실행)
3. [API Key 설정](#3-api-key-설정)
   - [Google API Key 발급](#31-google-api-key-발급)
   - [설정 방법](#32-설정-방법)
4. [기본 사용법](#4-기본-사용법)
   - [후보 생성 (탭 1)](#41-후보-생성-탭-1)
   - [이미지 개선 (탭 2)](#42-이미지-개선-탭-2)
5. [고급 설정](#5-고급-설정)
   - [파이프라인 모드](#51-파이프라인-모드)
   - [검색 설정](#52-검색-설정)
   - [모델 설정](#53-모델-설정)
6. [결과 관리](#6-결과-관리)
7. [문제 해결](#7-문제-해결)
8. [API 비용 안내](#8-api-비용-안내)
9. [FAQ](#9-faq)

---

## 1. PaperBanana 소개

**PaperBanana**는 AI를 활용하여 학술 논문의 도표와 다이어그램을 자동으로 생성하는 도구입니다. 논문의 방법론 섹션을 입력하면 출판 품질의 전문적인 다이어그램을 생성해 드립니다.

### 주요 특징

- **5단계 에이전트 파이프라인**: 검색자 → 기획자 → 스타일리스트 → 시각화자 → 평가자
- **병렬 후보 생성**: 한 번에 최대 20개의 다양한 후보 생성
- **반복적 개선**: 자동으로 품질을 개선하는 평가자 에이전트
- **고해상도 출력**: 2K/4K 해상도의 고품질 이미지 생성

### 작동 원리

```
논문 방법론 → AI 분석 → 다이어그램 설계 → 이미지 생성 → 품질 평가 → 최종 출력
```

---

## 2. 시작하기

### 2.1 설치 방법

#### Windows

```bash
# 1. 저장소 다운로드
git clone https://github.com/dwzhu-pku/PaperBanana.git
cd PaperBanana

# 2. 초기 설정 실행
setup.bat
```

#### Mac/Linux

```bash
# 1. 저장소 다운로드
git clone https://github.com/dwzhu-pku/PaperBanana.git
cd PaperBanana

# 2. 초기 설정 실행
chmod +x setup.sh
./setup.sh
```

### 2.2 첫 실행

#### Windows
```bash
start.bat
```

#### Mac/Linux
```bash
chmod +x start.sh
./start.sh
```

또는 직접 실행:
```bash
.venv/bin/python -m streamlit run demo.py  # Mac/Linux
.venv\Scripts\python -m streamlit run demo.py  # Windows
```

브라우저가 자동으로 열리고 `http://localhost:8501`에서 PaperBanana에 접속할 수 있습니다.

---

## 3. API Key 설정

PaperBanana를 사용하려면 **Google AI Studio**에서 발급받은 API Key가 필요합니다.

### 3.1 Google API Key 발급

1. [Google AI Studio](https://aistudio.google.com/app/apikey) 접속
2. Google 계정으로 로그인
3. **"Create API Key"** 버튼 클릭
4. 새 프로젝트 선택 또는 생성
5. 생성된 API Key를 복사 (예: `AIza...`)

> **참고**: API Key는 물론 물론 발급되며, 월간 사용량 제한이 있습니다. 상업적 사용 시 유료 플랜 확인이 필요할 수 있습니다.

### 3.2 설정 방법

#### 방법 1: 웹 인터페이스에서 설정 (권장)

1. PaperBanana 웹 페이지 좌측 사이드바의 **"🔐 API 설정"** 섹션 확인
2. **Google API Key** 입력란에 복사한 키 붙여넣기
3. **텍스트 모델**과 **이미지 모델** 확인 (기본값 사용 권장)
   - 텍스트 모델: `gemini-2.0-flash-exp`
   - 이미지 모델: `gemini-2.0-flash-exp-image-generation`
4. **"💾 API 설정 저장"** 버튼 클릭
5. 설정 완료 메시지 확인

#### 방법 2: 설정 파일에 직접 입력

`configs/model_config.yaml` 파일을 열어 다음과 같이 설정:

```yaml
defaults:
  model_name: "gemini-2.0-flash-exp"
  image_model_name: "gemini-2.0-flash-exp-image-generation"

api_keys:
  google_api_key: "YOUR_API_KEY_HERE"
```

---

## 4. 기본 사용법

### 4.1 후보 생성 (탭 1)

논문의 방법론을 입력하여 여러 다이어그램 후보를 생성합니다.

#### 입력 방법

1. **"📊 후보 생성"** 탭 선택
2. **방법론 섹션 내용** 입력
   - 논문의 Method 섹션을 Markdown 형식으로 붙여넣기
   - 예시: "We propose a novel framework consisting of three modules..."
3. **그림 캡션** 입력
   - 생성할 다이어그램의 설명 작성
   - 예시: "Figure 1: Overview of our proposed framework"
4. **예시 불러오기** 드롭다운에서 샘플 데이터 확인 가능

#### 설정 옵션

| 설정 항목 | 설명 | 권장값 |
|---------|------|--------|
| **파이프라인 모드** | 사용할 에이전트 조합 | `demo_planner_critic` (기본) |
| **검색 설정** | 참조 다이어그램 검색 방식 | `auto` (자동) |
| **후보 개수** | 생성할 이미지 수 (1-20) | 10개 |
| **화면 비율** | 출력 이미지 비율 | `16:9` 또는 `21:9` |
| **최대 평가자 라운드** | 품질 개선 반복 횟수 | 3회 |

#### 생성 실행

1. **"🚀 후보 생성"** 버튼 클릭
2. 생성 중 스피너가 표시됨 (1-3분 소요)
3. 생성된 후보들이 그리드로 표시됨
4. 마음에 드는 후보 선택하여 다운로드

### 4.2 이미지 개선 (탭 2)

생성된 이미지나 기존 이미지를 고해상도로 개선합니다.

#### 사용 방법

1. **"✨ 이미지 개선"** 탭 선택
2. **이미지 파일 선택** 버튼 클릭하여 이미지 업로드
   - 지원 형식: PNG, JPG, JPEG
3. **편집 지침** 입력
   - 변경하고 싶은 사항 설명
   - 예시: "학술 논문 스타일의 색상으로 변경"
   - 예시: "텍스트를 더 크고 굵게"
   - 예시: "모든 것을 그대로 유지하고 해상도만 높여줘"
4. **목표 해상도** 선택: `2K` 또는 `4K`
5. **종횡비** 선택
6. **"✨ 이미지 개선"** 버튼 클릭
7. 개선된 이미지 다운로드

---

## 5. 고급 설정

### 5.1 파이프라인 모드

| 모드 | 설명 | 사용 시기 |
|-----|------|----------|
| **demo_planner_critic** | 기획자 → 시각화자 → 평가자 → 시각화자 | 기본 사용 |
| **demo_full** | 검색자 → 기획자 → 스타일리스트 → 시각화자 → 평가자 → 시각화자 | 더 미적인 결과 원할 때 |

> **팁**: `demo_full` 모드는 스타일리스트가 미적으로 더 예쁜 다이어그램을 만들지만, 과도하게 단순화될 수 있습니다. 두 모드를 모두 시도하여 더 나은 것을 선택하세요.

### 5.2 검색 설정

| 설정 | 설명 |
|-----|------|
| **auto** | 자동으로 가장 적합한 참조 선택 (권장) |
| **manual** | 지정된 참조 사용 |
| **random** | 무작위 참조 선택 |
| **none** | 참조 없이 생성 |

### 5.3 모델 설정

기본 설정으로도 대부분의 경우 잘 작동합니다. 고급 사용자를 위한 모델 옵션:

- **텍스트 모델**: 텍스트 생성 및 분석에 사용
  - `gemini-2.0-flash-exp` (권장)
  
- **이미지 모델**: 이미지 생성에 사용
  - `gemini-2.0-flash-exp-image-generation` (권장)

---

## 6. 결과 관리

### 개별 다운로드

각 후보 이미지 하단의 **"⬇️ 다운로드"** 버튼 클릭

### 일괄 다운로드

생성된 모든 후보를 ZIP 파일로 다운로드:
1. 결과 화면 하단의 **"💾 일괄 다운로드"** 섹션 확인
2. **"⬇️ ZIP 다운로드"** 버튼 클릭
3. 모든 후보 이미지가 한 번에 다운로드됨

### JSON 결과 저장

생성 결과는 자동으로 `results/demo/` 폴더에 JSON 형식으로 저장됩니다.

---

## 7. 문제 해결

### API Key 오류

**증상**: "API Key가 설정되지 않았습니다" 메시지 표시

**해결 방법**:
1. 사이드바의 **"🔐 API 설정"** 섹션 확인
2. API Key가 올바르게 입력되었는지 확인
3. **"💾 API 설정 저장"** 버튼 클릭
4. 페이지 새로고침 (F5)

### 이미지 생성 실패

**증상**: "처리 중 오류 발생" 메시지

**해결 방법**:
1. API Key 유효성 확인 (Google AI Studio에서 테스트)
2. 입력 텍스트 길이 확인 (너무 길면 요약)
3. 모델 이름이 올바른지 확인
4. 인터넷 연결 확인

### Streamlit 실행 오류

**증상**: `streamlit` 명령어를 찾을 수 없음

**해결 방법**:
```bash
# 가상환경 활성화 확인
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Mac/Linux

# 직접 실행
python -m streamlit run demo.py
```

### 메모리 부족

**증상**: 생성 중 프로그램이 멈춤

**해결 방법**:
- 후보 개수를 5개 이하로 줄이기
- 더 작은 해상도(2K) 선택
- 다른 프로그램 종료 후 재시도

---

## 8. API 비용 안내

### 💰 예상 사용 비용

PaperBanana는 Google Gemini API를 사용하며, 사용량에 따라 비용이 발생합니다.

#### 📊 기본 설정별 비용 (10개 후보 + 3회 평가자 라운드 기준)

| 항목 | API 호출 횟수 | 예상 비용 (USD) | 예상 비용 (KRW) |
|-----|--------------|----------------|----------------|
| **Retriever** (검색) | 10회 | $0.07 | ~₩95 |
| **Planner** (기획) | 10회 | $0.09 | ~₩122 |
| **Visualizer** (이미지 생성) | 40회 | $0.01 | ~₩19 |
| **Critic** (평가) | 30회 | $0.07 | ~₩97 |
| **총합** | **90회** | **~$0.24** | **~₩330** |

> **참고**: 이미지 생성은 Google AI Studio 무제 티어 내에서 무제로 제공됩니다.

#### 💵 Gemini 2.0 Flash API 가격 (2025년 기준)

| 구분 | 가격 |
|-----|------|
| **입력 토큰** | $0.10 / 1M tokens |
| **출력 토큰** | $0.40 / 1M tokens |
| **이미지 생성** | 무제 (묵제 티어 내) |

#### 💡 비용 절감 방법

| 방법 | 절감 효과 | 설명 |
|-----|----------|------|
| **후보 개수 감소** | 50% 절감 | 10개 → 5개로 줄이면 비용 절반 |
| **평가자 라운드 감소** | 30% 절감 | 3회 → 2회로 줄이면 비용 절감 |
| **검색 설정 변경** | Retriever 생략 | "auto" → "none"으로 변경 |
| **demo_planner_critic 사용** | Stylist 1회 절감 | demo_full보다 효율적 |

#### ⚠️ 무제 사용량 한도

Google AI Studio 무제 티어:
- **일일 요청**: 1,500회
- **분당 토큰**: 1M tokens
- **분당 요청**: 15회

위 설정으로는 **하루 5-10회** 정도 무제 사용 가능합니다.

---

## 9. FAQ

### Q: API 사용료가 발생하나요?

A: Google AI Studio는 물론 사용량 한도 내에서 물론으로 제공됩니다. 상업적 사용이나 대량 생성 시 유료 플랜 확인이 필요할 수 있습니다.

### Q: 생성된 이미지의 저작권은 어떻게 되나요?

A: 생성된 이미지는 사용자의 입력을 바탕으로 AI가 생성한 것으로, 일반적으로 사용자가 자유롭게 사용할 수 있습니다. 단, 학술 논문에 사용 시 AI 도구 사용을 명시하는 것이 원칙입니다.

### Q: 한글 논문도 지원하나요?

A: 네, 한글 논문도 지원합니다. 다만, 영어 논문보다 생성 품질이 약간 낮을 수 있습니다.

### Q: 최대 얼마나 긴 텍스트를 입력할 수 있나요?

A: 모델의 컨텍스트 창 크기에 따라 제한되지만, 일반적으로 수천 토큰까지 입력 가능합니다. 너무 길 경우 핵심 내용만 요약하여 입력하세요.

### Q: 생성 결과가 항상 다른가요?

A: 네, AI 생성 특성상 동일한 입력에도 약간씩 다른 결과가 나올 수 있습니다. 마음에 드는 후보를 선택하여 다운로드하세요.

### Q: 기존에 설정한 API Key를 변경하려면?

A: 사이드바의 **"🔄 설정 초기화"** 버튼을 클릭한 후 새로운 API Key를 입력하세요.

---

## 📞 지원 및 문의

- **GitHub Issues**: [https://github.com/dwzhu-pku/PaperBanana/issues](https://github.com/dwzhu-pku/PaperBanana/issues)
- **Hugging Face**: [https://huggingface.co/papers/2601.23265](https://huggingface.co/papers/2601.23265)

---

**버전**: 1.0  
**마지막 업데이트**: 2025년 2월
